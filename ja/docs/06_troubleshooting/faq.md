---
title: よくある質問（FAQ）
description: Nekro Agent使用中の一般的な問題と解決策のコレクション。デプロイメント、設定、機能に関する様々な一般的な問題をカバー
---

# よくある質問

このドキュメントでは、Nekro Agentの使用中に遭遇する一般的な問題と解決策をまとめています。

## デプロイメント関連

### Q: Dockerコンテナが起動しない

**A**: 一般的な原因には以下が含まれます：

1. ポート競合：ポート8021と6099が占有されているか確認
2. 設定ファイルエラー：configs/nekro-agent.yamlの形式が正しいか確認
3. 権限の問題：インストールディレクトリに正しい権限があることを確認

詳細なエラー情報についてはログを確認：

```bash
docker-compose logs -f nekro_agent
```

### Q: インストール後にWebUIにアクセスできない

**A**: 以下を確認してください：

1. コンテナが正常に実行されているか：`docker-compose ps`
2. ファイアウォールがポート8021を開いているか
3. サーバーのセキュリティグループ設定がこのポートへのアクセスを許可しているか
4. 別のブラウザでアクセスを試みる

### Q: `Cannot connect to the Docker daemon`エラーが発生する

**A**: Dockerサービスが開始されていないか、ユーザー権限の問題があります。

```bash
# Dockerサービスを開始
sudo systemctl start docker
```

### Q: `port is already allocated`エラーが発生する

**A**: 指定されたポートが他のプログラムによって既に占有されています。

```bash
# ポートを占有しているプロセスを確認
sudo lsof -i :8021

# .envファイルでポート設定を変更
vim .env
# NEKRO_AGENT_PORTまたはNAPCAT_PORTを他の未使用のポートに変更
```

### Q: `Failed to pull image`エラーが発生する

**A**: ネットワーク接続の問題またはDocker Hubアクセスの制限。解決策：Dockerイメージアクセラレーションを設定。

### Q: 同じデバイスに複数のNekroAgentインスタンスをデプロイする方法は？

**A**: まず`export NEKRO_DATA_DIR=<your_directory>`を使用して競合しないディレクトリを設定し、次にインストールスクリプトを実行して`.env`ファイルをプロンプトに従って変更し、適切なプレフィックスを設定してコンテナ名の競合を回避し、適切なポートを設定してポート競合を回避し、デプロイメントを完了させます。

## 設定関連

### Q: デフォルトポートを変更する方法は？

**A**: `.env`ファイルを編集し、以下の変数を変更：

```
NEKRO_AGENT_PORT=8021  # 希望のポートに変更
NAPCAT_PORT=6099       # NapCatを使用している場合、このポートも変更可能
```

変更後、サービスを再起動する必要があります：`docker-compose down && docker-compose up -d`

### Q: モデルAPI呼び出しが失敗した場合の対処法は？

**A**: 考えられる原因：

1. APIキーエラー：API_KEY設定を確認
2. ネットワーク問題：ネットワーク接続を確認、一部のモデルプロバイダーはアクセスにプロキシ設定が必要
3. モデル名エラー：CHAT_MODEL名が正しいか確認
4. 残高不足：APIアカウント残高を確認

## 機能関連

### Q: ボットがテキスト/画像以外のファイルコンテンツを送信できないのはなぜですか？

**A**: ご使用のプロトコル実装がファイル送信をサポートしているか確認してください。サポートしている場合は、続行してください。

OneBot V11プロトコルの制限により、ファイルを送信する際、プロトコルエンドポイントがファイルパスに直接アクセスできる必要があります。したがって、実際のデプロイ状況に応じてNekroAgent設定のファイルアクセスベースパスを設定する必要があります。以下に例を示します：

プロトコルエンドポイントがコンテナにデプロイされていると仮定すると、まずNekroAgentのデータディレクトリをプロトコルエンドポイントコンテナにマウントする必要があります。つまり、`${HOME}/srv/nekro_agent:/app/nekro_agent_data`、次にNekroAgentのファイルアクセスベースパスを設定：

```
SANDBOX_ONEBOT_SERVER_MOUNT_DIR: "/app/nekro_agent_data"
```

このようにすることで、NekroAgentはプロトコルエンドポイントのデータディレクトリにアクセスでき、ファイルコンテンツを送信できます。

### Q: AIが私のメッセージに応答しない場合の対処法は？

**A**: 考えられる原因：

1. プロトコルエンドポイント接続の問題：プロトコルエンドポイントが正しく接続されているか確認
2. メッセージフィルタリング設定：WebUIでメッセージ無視設定を確認
3. AI応答生成失敗：ログで具体的なエラーを確認

### Q: AIペルソナを切り替える方法は？

**A**: WebUIの「ペルソナ管理」でペルソナ情報を設定し、次に「セッション管理」でペルソナを選択

### Q: サンドボックスコード実行がタイムアウトした場合の対処法は？

**A**: サンドボックス実行時間制限を調整：

```yaml
SANDBOX_RUNTIME_LIMIT: 60 # より大きな値に調整、単位は秒
```

### Q: Nekro Agentを完全にアンインストールする方法は？

**A**: 以下のコマンドを実行：

```bash
# コンテナを停止して削除
cd <your_installation_directory>
sudo docker-compose down

# マウントされたボリュームを削除（インストール時にインスタンスプレフィックスが設定された場合、以下のマウントボリュームに対応するプレフィックスを追加する必要があります）
sudo docker volume rm nekro_postgres_data
sudo docker volume rm nekro_qdrant_data

# オプション：イメージを削除
sudo docker rmi kromiose/nekro-agent kromiose/nekro-agent-sandbox

# インストールディレクトリを削除
cd ..
rm -rf <installation_directory>
```

## サポートを受ける

上記の方法で問題が解決しない場合、以下のチャネルを通じてサポートを受けることができます：

1. [GitHub Issues](https://github.com/KroMiose/nekro-agent/issues)を確認
2. 公式QQグループに参加：636925153
3. 問題を説明して新しいIssueを提出