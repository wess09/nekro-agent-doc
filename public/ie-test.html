<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>IE检测测试页面</title>
    <style type="text/css">
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border: 1px solid #ddd;
            max-width: 800px;
            margin: 0 auto;
        }
        .result {
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
        }
        .ie {
            background-color: #ffe6e6;
            border-color: #ff9999;
        }
        .not-ie {
            background-color: #e6ffe6;
            border-color: #99ff99;
        }
    </style>
    <script type="text/javascript">
        function detectIE() {
            var ua = window.navigator.userAgent;
            
            // 检测IE 10及以下版本
            var isIE10orLower = ua.indexOf('MSIE ') > -1;
            
            // 检测IE 11
            var isIE11 = ua.indexOf('Trident/') > -1 && ua.indexOf('rv:') > -1;
            
            // 检测是否为Edge旧版本（基于EdgeHTML）
            var isOldEdge = ua.indexOf('Edge/') > -1;
            
            var isIE = isIE10orLower || isIE11;
            
            var resultDiv = document.getElementById('result');
            var uaDiv = document.getElementById('userAgent');
            
            uaDiv.innerHTML = 'User Agent: ' + ua;
            
            if (isIE) {
                resultDiv.className = 'result ie';
                resultDiv.innerHTML = '检测到IE浏览器！将会跳转到不兼容页面。';
                
                // 模拟跳转
                setTimeout(function() {
                    if (confirm('检测到IE浏览器，是否跳转到不兼容页面？')) {
                        window.location.href = '/ie-incompatible.html';
                    }
                }, 2000);
            } else if (isOldEdge) {
                resultDiv.className = 'result ie';
                resultDiv.innerHTML = '检测到旧版Edge浏览器！建议升级到新版Edge或使用其他现代浏览器。';
            } else {
                resultDiv.className = 'result not-ie';
                resultDiv.innerHTML = '未检测到IE浏览器，可以使用现代功能。';
            }
        }
        
        window.onload = detectIE;
    </script>
</head>
<body>
    <div class="container">
        <h1>IE浏览器检测测试</h1>
        <p>此页面用于测试IE浏览器检测功能是否正常工作。</p>
        
        <div id="result" class="result">
            正在检测浏览器...
        </div>
        
        <div id="userAgent" class="result">
            User Agent: 加载中...
        </div>
        
        <p><a href="/ie-incompatible.html">查看IE不兼容页面</a></p>
        <p><a href="/">返回首页</a></p>
    </div>
</body>
</html>